## DNS

### 1. Domain
- Domain: IP 주소와 매핑되는 문자열
    ```text
    루트 도메인: 서브 도메인을 포함하지 않은 도메인 (루트 = 베이스, 베어, 네이키드, 루트 에이펙스, 존 에이펙스 등)
        * 예시 - example.com.
    서브 도메인: 루트 도메인에서 문자열이 추가된 도메인
        * 예시 - test.example.com.
    ```
- TLDs (Top Level Domains): DNS 계층 구조의 두 번째 레벨
    ```text
    Country Code TLDs: 나라별 코드 (2자리)
        * 예시 - .kr, .jp, .uk
    Sponsored TLDs: 사설 조직이나 기관
        * 예시 - .edu, .gov
    New generic TLDs: 기타
        * 예시 - .blog, .tech
    ```
  
### 2. DNS (Domain Name System)
- DNS record: DNS 서버가 전송받은 패킷(도메인)의 처리 지침
    ```text
    A 레코드: IPv4 주소와 연결
    AAAA 레코드: IPv6 주소와 연결
    MX 레코드: 메일 서버와 연결
    ```
- DNS zone: DNS 레코드의 집합
    ```text
    examlple.com (루트 도메인)
    │
    ├ www.example.com (서브 도메인)
    ├ mail.example.com (서브 도메인)
    └ blog.example.com (서브 도메인)
    ```
- Zone file: DNS 존 정보를 저장한 텍스트 파일
- DNS query: 도메인에 해당하는 정보를 요청하는 쿼리
- Name server: Zone file 기반으로 DNS query 요청을 처리하는 서버
  - Authoritative: DNS 원본 정보를 보유한 최상위 네임 서버
  - None-authoritative: 최상위 네임 서버의 정보를 캐싱, 응답하는 서버
- DNS resolver: 사용자가 가장 먼저 DNS 쿼리를 요청하는 대상, 일반적으로 인터넷 서비스 제공자가 관리

- DNS 계층 구조
    ```mermaid
    graph TD
        Root[DNS Root]
    
        TLD_KR["Top Level Domain (.kr)"]
        TLD_COM["Top Level Domain (.com)"]
    
        NS_KR1[Name server]
        NS_KR2[Name server]
        NS_COM1[Name server]
        NS_COM2[Name server]
    
        subgraph Record_KR1["Records"]
            Layer1["Record"]
            Layer2["Record"]
            Layer3["Record"]
        end
        subgraph Record_KR2["Records"]
            Layer4["Record"]
            Layer5["Record"]
            Layer6["Record"]
        end
        subgraph Record_COM1["Records"]
            Layer7["Record"]
            Layer8["Record"]
            Layer9["Record"]
        end
        subgraph Record_COM2["Records"]
            Layer10["Record"]
            Layer11["Record"]
            Layer12["Record"]
        end
        
        Root --> TLD_KR
        Root --> TLD_COM
    
        TLD_KR --> NS_KR1
        TLD_KR --> NS_KR2
    
        TLD_COM --> NS_COM1
        TLD_COM --> NS_COM2
    
        NS_KR1 --> Record_KR1
        NS_KR2 --> Record_KR2
        NS_COM1 --> Record_COM1
        NS_COM2 --> Record_COM2
        
    ```

- DNS 조회
    ```mermaid
    sequenceDiagram
        participant C as Client
        participant DRS as DNS Resolver
        participant DR as DNS Root
        participant TLD as Top Level Domain
        participant NS as Name Server
    
        C->>DRS: 도메인 네임 쿼리
        DRS->>DR: 루트 DNS에 쿼리
        DR->>DRS: TLD 서버 주소 응답
        DRS->>TLD: TLD 서버에 쿼리
        TLD->>DRS: Name 서버 주소 응답
        DRS->>NS: DNS 레코드 쿼리
        NS->>DRS: DNS 레코드에 해당하는 IP 주소 응답
        DRS->>C: 최종 IP 주소 응답
    ```