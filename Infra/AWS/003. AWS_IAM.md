## IAM (Identity and Access Management)

### 1. 역할

- AWS 의 보안 및 관리를 담당하는 글로벌 서비스
- AWS 계정 관리, 계정 권한 제어, 계정 보안 관리
- 다른 계정과의 리소스 공유

### 2. 구성

- 사용자 (User)
  - AWS 를 사용하는 사람 혹은 애플리케이션


- 그룹 (Group)
  - IAM 사용자의 집합
  - 그룹에 속한 사용자는 그룹에 부여된 권한을 사용 가능


- 역할 (Role)
  - AWS 권한의 집합
  - 특정 사용자나 그룹에서 역할을 받아서 사용


- 정책 (Policy)
  - 사용자, 그룹, 역할이 어떤 행위를 할 수 있는지 정의된 JSON 문서
    - 구성
    ```text
    Resource: 대상 AWS 리소스
    Action: 행동
    Effect: 허용/거부
    Condition: 정책 적용 조건 (IP 주소, 시간, 태그 등)
    ```

### 3. 권한 검증 과정

- 사용자
    ```mermaid
    flowchart TD
        
        U[User] -->  C1{"사용자가<br>해당 리소스의 정책을<br>보유하고 있는가?"}
        C1 --> |네| R(AWS Resource)
        C1 --> |아니오| G{"사용자가 속한 그룹이<br>해당 리소스의 정책을<br>보유하고 있는가?"}
        G --> |네| R
        G --> |아니오| UA(Unauthorized)
    ```

- 서비스
  ```mermaid
    flowchart TD
        
        S[AWS Service] -->  C1{"서비스가<br>해당 리소스의 역할을<br>보유하고 있는가?"}
        C1 --> |네| R(AWS Resource)
        C1 --> |아니오| UA(Unauthorized)
  ```

### 4. 자격 증명

- 콘솔 방식
  - 공통: MFA(Optional)
  - 루트 사용자: 루트 Email, 비밀번호
  - IAM 사용자: 별칭, 비밀번호


- 프로그래밍 방식
  - AWS CLI, SDK 사용 시 필요한 자격 증명
  - Access key 구성
    - Access Key ID: 유저 이름에 해당하는 키 (공개 가능)
    - Secret Access Key: 비밀번호에 해당하는 키, 발급 시점에만 확인 가능 (공개 불가)
  - IAM 사용자 별 2개의 Access key 쌍 발급 가능
    - Access key 교체 시 2개를 발급하여 교체 후 이전 키 폐기
  - 프로파일: 자격 증명에 이름을 부여해서 스위칭 가능 (ex - dev, test, prod 등)