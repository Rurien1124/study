## Amazon EC2 (Elastic Compute Cloud)

### 1. 소개

- AWS의 컴퓨팅을 빌려 쓰는 서비스
- AWS에서 가장 중요한 서비스 중 하나

### 2. 구조

- Instance
  - EC2 에서 컴퓨팅을 담당
  - 저장을 담당하는 EBS(Elastic Block Store)와 네트워크로 연결
  - 하나의 가용 영역에만 존재
  - 저장 방식 (둘 중 하나만 선택하여 사용)
    - EBS(Elastic Block Store)
    - Instance store
      ```mermaid
      flowchart TD
      
      subgraph EBS[EBS 방식]
          EC2_1[Instance] --> |"네트워크 연결"| EV
          EV[("EBS 볼륨")]
      end
    
      subgraph IS[Instance store 방식]
          subgraph EC2[Instance]
              ISV[("인스턴스 스토리지 볼륨")]
          end
      end
      ```
  - Instance type (인스턴스 유형)
    - 인스턴스의 역할에 따라 CPU, 메모리, 스토리지, 네트워크 등을 조합한 구성
    - 사용 목적에 따라 최적화
    - 유형 별 명칭 존재 (t유형, m유형, inf유형 등)
      ![instance_type_naming_convention](/images/instance-type-naming-convention.png)
      ```text
      c7gn.2xlarge: 인스턴스 유형
      c7gn: 인스턴스 패밀리
      c: c 인스턴스 타입
      7: 7번째 세대
      g: AWS Graviton 프로세서 사용
      n: 네트워크 최적화
      2xlarge: 인스턴스 크기
      ```
      <a href="https://aws.amazon.com/ko/ec2/instance-types/">인스턴스 유형 DOCUMENT</a>

  - Instance 크기
    - 동일한 인스턴스 유형 내에서 여러 크기가 존재
    - CPU 개수, 메모리 크기, 성능 등으로 결정

- EBS (Elastic Block Store)
  - 네트워크로 연결된 가상의 하드 드라이브
  - EC2 인스턴스가 종료, 삭제돼도 유지 가능
  - Loose coupling 으로, 인스턴스 유형 변경이나 드라이브 추가에 용이함
  - 반드시 EC2 인스턴스와 같은 하나의 가용 영역에 존재해야 함
  - 종류
    ```text
    GP (General Purpose): 범용, SSD
    IOPS (Provisioned IOPS or IO): 프로비저닝 된 IOPS, SSD
    Throughput Optimized HDD or ST: 쓰루풋 최적화 (대용량 데이터 전송), HDD
    SC (Cold HDD): HDD
    Standard: HDD
    ```
  - Snapshot
    - EBS 의 특정 시점 전체를 저장한 이미지, 자동화 가능
    - 증분식으로, 바뀐 부분의 볼륨만 저장
    - S3 에 저장됨

- AMI (Amazon Machine Image)
  - EC2 인스턴스 실행을 위한 정보를 모아둔 템플릿
  - 구성
    ```text
    1개 이상의 EBS 스냅샷
    사용 권한
    블록 디바이스 매핑 (EC2 인스턴스를 위한 볼륨 정보)
    ```
  - 생성 방법
    - EBS 기반: 스냅샷을 사용하여 생성
    - 인스턴스 저장 기반: S3에 저장된 템플릿을 사용하여 생성

- Security Group (보안 그룹)
  - EC2 의 방화벽 역할
  - Whitelist 구조, 명시적으로 포트 활성화 필요
